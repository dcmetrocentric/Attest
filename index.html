<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
<title>ATTEST Demo</title>
<style>
:root{
  --bg:#0b1220;
  --card:#111a2e;
  --accent:#6d7cff;
  --accent2:#22c55e;
  --text:#e5ecff;
  --muted:#9fb0d9;
}
*{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
body{margin:0;background:linear-gradient(180deg,#0b1220,#0e1730);color:var(--text)}
#app{min-height:100vh;display:flex;flex-direction:column}
header{padding:16px 18px;font-weight:700;letter-spacing:.5px}
video{width:100%;height:60vh;object-fit:cover;background:#000}
.overlay{
 position:relative;margin-top:-120px;padding:18px;
}
.card{
 background:rgba(17,26,46,.92);
 border-radius:22px;padding:18px;
 box-shadow:0 20px 40px rgba(0,0,0,.35);
}
.hint{color:var(--muted);margin-top:6px}
.big{font-size:24px;font-weight:700}
.center{display:flex;align-items:center;justify-content:center;text-align:center}
button{
 width:100%;padding:16px;border:none;border-radius:16px;
 font-size:18px;font-weight:700;background:var(--accent);color:white;margin-top:14px
}
button.secondary{background:#263456}
button.green{background:var(--accent2)}
.hidden{display:none}
.progress{
 height:6px;background:#263456;border-radius:6px;margin-top:10px;overflow:hidden
}
.bar{height:100%;background:var(--accent2);width:0%}
.timer{font-size:36px;font-weight:800;margin-top:6px}
.dim{position:fixed;inset:0;background:#000;display:none;align-items:center;justify-content:center;flex-direction:column}
.wallet{
 width:280px;height:170px;border-radius:22px;background:linear-gradient(135deg,#4f46e5,#7c8cff);
 box-shadow:0 15px 40px rgba(0,0,0,.5);display:flex;align-items:flex-end;padding:16px
}
.success{font-size:28px;margin-top:16px}
.small{color:var(--muted);margin-top:6px}
</style>
</head>
<body>
<div id="app">
<header>ATTEST</header>

<!-- CAMERA -->
<video id="cam" autoplay playsinline muted></video>

<div class="overlay">
  <div id="scanCard" class="card">
    <div class="big">What are you buying?</div>
    <div class="hint">Point at the item or receipt</div>
    <div class="progress"><div id="scanBar" class="bar"></div></div>
    <button id="startScan" class="secondary">Simulate Scan</button>
  </div>

  <div id="recognizedCard" class="card hidden">
    <div class="big">Home Depot detected</div>
    <div class="hint">Category: Hardware ‚Ä¢ Est: $42</div>
    <div class="small">Looks good ‚Äî this is covered.</div>
    <button id="approveBtn" class="green">Activate Work Card</button>
  </div>

  <div id="activeCard" class="card hidden center">
    <div>
      <div class="big">Your work card is ready</div>
      <div class="small">Tap your phone to pay</div>
      <div id="timer" class="timer">10:00</div>
      <button id="tapBtn">Tap to Pay</button>
    </div>
  </div>

  <div id="doneCard" class="card hidden center">
    <div>
      <div class="big">All set üëç</div>
      <div class="small">Transaction logged<br/>No expense report needed</div>
      <button onclick="location.reload()">Done</button>
    </div>
  </div>
</div>
</div>

<div id="wallet" class="dim">
  <div class="wallet"></div>
  <div class="success">Payment Authorized</div>
  <div class="small">Receipt automatically recorded</div>
</div>

<script>
// camera
const video=document.getElementById('cam');
async function startCamera(){
  try{
    const stream=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});
    video.srcObject=stream;
  }catch(e){
    console.log("Camera unavailable, continuing demo");
  }
}
startCamera();

// scan simulation
const scanBar=document.getElementById('scanBar');
document.getElementById('startScan').onclick=()=>{
  let p=0;
  const i=setInterval(()=>{
    p+=8;scanBar.style.width=p+"%";
    if(p>=100){
      clearInterval(i);
      document.getElementById('scanCard').classList.add('hidden');
      document.getElementById('recognizedCard').classList.remove('hidden');
      if(navigator.vibrate) navigator.vibrate(60);
    }
  },120);
};

// approval
document.getElementById('approveBtn').onclick=()=>{
  document.getElementById('recognizedCard').classList.add('hidden');
  document.getElementById('activeCard').classList.remove('hidden');
  startTimer();
};

// timer
let remaining=600, t;
function startTimer(){
  t=setInterval(()=>{
    remaining--;
    const m=Math.floor(remaining/60);
    const s=(remaining%60).toString().padStart(2,'0');
    document.getElementById('timer').textContent=`${m}:${s}`;
    if(remaining<=0){clearInterval(t);location.reload();}
  },1000);
}

// tap to pay
document.getElementById('tapBtn').onclick=()=>{
  document.getElementById('wallet').style.display='flex';
  if(navigator.vibrate) navigator.vibrate([40,60,40]);
  setTimeout(()=>{
    document.getElementById('wallet').style.display='none';
    document.getElementById('activeCard').classList.add('hidden');
    document.getElementById('doneCard').classList.remove('hidden');
    clearInterval(t);
  },2200);
};
</script>
</body>
</html>
